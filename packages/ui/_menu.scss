@import "../core/index";
// Menu 컴포넌트 스타일 (Dropdown 및 Context Menu용)
// VDS 3.0 디자인 가이드라인 기준 (Figma node-id=1039-8824)

// --- 믹스인 (Mixins) ---
@mixin menu-size-small {
    padding: 6px;
    border-radius: $radius-8;

    .menu__item {
        padding: 8px 10px;
        gap: 6px;
        @include body-13-r();
    }

    .menu__group-title {
        padding: 6px 8px 2px;
        @include caption-11-r();
    }

    .menu__chevron,
    .menu__selected-check,
    .menu__icon {
        width: 16px;
        height: 16px;
    }
}

.menu {
    position: absolute;
    // ... (existing styles)
    top: calc(100% + 4px);
    left: 0;
    width: 100%;
    min-width: 180px;
    background-color: var(--fill-surface-primary);
    border: 1px solid var(--line-secondary);
    border-radius: $radius-12;
    @include elevation-40();
    z-index: $z-index-dropdown;
    padding: 8px;
    box-sizing: border-box;
    display: none;
    opacity: 0;
    transform: translateY(-8px);
    transition: opacity 0.2s ease, transform 0.2s ease;

    &.is-open {
        display: block;
        opacity: 1;
        transform: translateY(0);
    }

    &--sub {
        top: -8px; // Align with parent item (approximated based on padding)
        left: 100%;
        margin-left: 4px;
        transform: none; // Reset initial transform for sub-menu
    }

    &__item {
        position: relative;
        display: flex;
        align-items: center;
        box-sizing: border-box;
        padding: 10px 12px;
        border-radius: $radius-6;
        cursor: pointer;
        gap: 8px;
        color: var(--label-primary);
        @include body-14-r();
        transition: all 0.2s ease;
        overflow: hidden;

        @include interaction-overlay(var(--label-primary), 'auto');

        &:hover:not(&--disabled) {

            // Show nested menu on hover
            >.menu {
                display: block;
                opacity: 1;
                transform: none;
            }
        }

        &--selected {
            color: var(--static-primary);
            @include label-14-r();

            .menu__selected-check {
                display: block;
            }
        }

        &--negative {
            color: var(--status-negative);
            @include interaction-overlay(var(--status-negative), 'light');

            .menu__icon {
                color: var(--status-negative);
            }
        }

        &--disabled {
            cursor: not-allowed;
            color: var(--label-quinary);
            pointer-events: none;
            opacity: 0.5;
        }
    }

    &__divider {
        height: 1px;
        background-color: var(--line-secondary);
        margin: 8px -8px; // 메뉴 패딩(8px) 상쇄를 위한 음수 마진 적용

        // Smart Logic: Automatically hide redundant dividers
        &:first-child {
            display: none;
        }

        &:last-child {
            display: none;
        }

        &+.menu__divider {
            display: none;
        }
    }

    &__icon {
        width: 17px;
        height: 17px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: inherit;
        flex-shrink: 0;

        svg {
            width: 100%;
            height: 100%;

            // 핫핑크 플레이스홀더 컬러만 타겟팅하여 교체 (두께 유지)
            [fill="#FF00CD"],
            [fill="#ff00cd"] {
                fill: currentColor !important;
            }

            [stroke="#FF00CD"],
            [stroke="#ff00cd"] {
                stroke: currentColor !important;
            }
        }
    }

    &__chevron {
        width: 17px;
        height: 17px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: var(--label-tertiary);
        margin-left: auto;
        flex-shrink: 0;

        svg {
            width: 100%;
            height: 100%;
            fill: currentColor;
        }
    }

    &__text {
        flex: 1;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }

    &__caption {
        @include caption-12-r();
        color: var(--label-tertiary);
        margin-left: auto;
    }

    &__group-title {
        @include caption-12-r();
        color: var(--label-quaternary);
        padding: 6px 10px 2px;
    }

    &__selected-check {
        display: none;
        width: 18px;
        height: 18px;
        background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%232262F6'%3E%3Cpath d='M18.2567 6.33096C18.6262 5.9205 19.2584 5.8873 19.6688 6.25674C20.0793 6.62621 20.1125 7.25836 19.7431 7.66885L10.7431 17.6688C10.3736 18.0793 9.74145 18.1125 9.33096 17.7431L4.33096 13.2431C3.9205 12.8736 3.8873 12.2415 4.25674 11.831C4.62621 11.4205 5.25836 11.3873 5.66885 11.7567L9.92471 15.5878L18.2567 6.33096Z'/%3E%3C/svg%3E");
        background-repeat: no-repeat;
        background-position: center;
        background-size: contain;
        margin-left: auto;
        flex-shrink: 0;
    }


    // --- 사이즈별 별도 패딩 조정 예시 ---
    &--small {
        @include menu-size-small();
    }
}